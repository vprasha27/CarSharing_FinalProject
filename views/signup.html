<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sign Up</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.4.1/dist/css/bootstrap.min.css" integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">
    <script src = "https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/crypto-js.min.js"></script>
    <style>
        body{
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            width: 100vw;
            margin:0px;
        }
    </style>
</head>
<div class="logo">
    <a href="http://localhost:2000/main">
    <img
      src="http://localhost:2000/img/Untitled.jpg"id="logo1"
      style="height: 70px; width: 300px"
      alt=""
    />
</a>
    <br><br>

<body>

   
    <div class ="mb-5">
        <h3 class ="mb-3">Sign Up</h3>
        <input  type="text" id="name" placeholder="Fullname" class ="form-control mb-3">
        <input type="text" id="username" placeholder="Username" class ="form-control mb-3">
        <input type="email" id="email" placeholder="Email" class ="form-control mb-3">
        <input type="password" id="password" placeholder="Password" class ="form-control mb-3">
        <input type="number" id="licence" placeholder="Driving Licence No" class ="form-control mb-3">
        <button id="submit" class = "btn btn-outline-primary mb-3 w-100 ">Submit</button>
        <a href="http://localhost:2000/login" class="badge badge-secondary py-1 w-100">Already Have an account</a>






    </div>

    <script type="module">
        // Import the functions you need from the SDKs you need
        import { initializeApp } from "https://www.gstatic.com/firebasejs/9.7.0/firebase-app.js";
        // TODO: Add SDKs for Firebase products that you want to use
        // https://firebase.google.com/docs/web/setup#available-libraries
      
        // Your web app's Firebase configuration
        const firebaseConfig = {
          apiKey: "AIzaSyBhQp6OlJYdgM-oD5zEFaHsnyP2FAPFC2A",
          authDomain: "zolocar.firebaseapp.com",
          databaseURL: "https://zolocar-default-rtdb.firebaseio.com",
          projectId: "zolocar",
          storageBucket: "zolocar.appspot.com",
          messagingSenderId: "777567502649",
          appId: "1:777567502649:web:46228fb640bd90590f28e8"
        };
      
        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
      

        import {getDatabase, ref, set, child, get}
        from "https://www.gstatic.com/firebasejs/9.7.0/firebase-database.js"

        const db=getDatabase();

        const fullnme=document.getElementById("name");
        const usrnme=document.getElementById("username");
        const mail=document.getElementById("email");
        const pwd=document.getElementById("password");
        const lcs=document.getElementById("licence");

        const reg=document.getElementById("submit");

        function RegisterUser(){
            const dbRef = ref(db);

            get(child(dbRef, "NewUsers/"+ usrnme.value)).then((snapshot)=>{

                if (snapshot.exists()){
                    alert("Account already exists");
                }

                else{

                    set(ref(db, "NewUsers/"+ usrnme.value),
                    {
                        fullname: fullnme.value,
                        email: mail.value,
                        username:usrnme.value, 
                        driving:lcs.value,
                        password: encPass()



                    })
                    .then(()=>{
                        alert("You are successfully registered")
                    })
                    .catch((error)=>{
                        alert("error" + error);
                    })
                }


            });


        }

        function encPass(){

        var pass12 = CryptoJS.AES.encrypt(pwd.value, pwd.value)
        return pass12.toString();
        }  


        reg.addEventListener('click', RegisterUser);










      </script>  
    
</body>
</html>